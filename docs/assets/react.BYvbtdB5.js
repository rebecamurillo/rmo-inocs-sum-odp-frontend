import{j as e,I}from"./input.C9WgGS_A.js";import{r}from"./index.mQ0qHaRU.js";import{R as E}from"./RButton.Os4tEyB8.js";import{T as P,a as $,b as A,c as j,d as v,e as K}from"./textarea.CbBqan8w.js";import{S as H}from"./select.C5poDIhb.js";import{F as U}from"./QuestionMarkCircleIcon.ESMEVjQ8.js";import{B as N}from"./Badge.00lvpe-2.js";import{F as y,L}from"./fieldset.DfCUz8we.js";import{g as z}from"./links.BishvqZb.js";import{M as G}from"./MapViewer.Bzgbq0Db.js";import"./index.JqWRG6qW.js";import"./index.GxtV8WE2.js";import"./Constants.BGkoVaDK.js";function T(a){if(!a)return"";const s=new Date(a);return Number.isNaN(s.getTime())?String(a):s.toISOString().slice(0,10)}var C=(a=>(a.NSM="NSM",a.PUBLIC_TRANSPORT="PUBLIC_TRANSPORT",a.PRIVATE="PRIVATE",a))(C||{}),p=(a=>(a.IN_SERVICE="IN_SERVICE",a.NEW="NEW",a.OPTIMIZATION_SCHEDULED="OPTIMIZATION_SCHEDULED",a.NOT_AVAILABLE="NOT_AVAILABLE",a))(p||{});function W({title:a,titleId:s,...t},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),a?r.createElement("title",{id:s},a):null,r.createElement("path",{d:"M4.214 3.227a.75.75 0 0 0-1.156-.955 8.97 8.97 0 0 0-1.856 3.825.75.75 0 0 0 1.466.316 7.47 7.47 0 0 1 1.546-3.186ZM16.942 2.272a.75.75 0 0 0-1.157.955 7.47 7.47 0 0 1 1.547 3.186.75.75 0 0 0 1.466-.316 8.971 8.971 0 0 0-1.856-3.825Z"}),r.createElement("path",{fillRule:"evenodd",d:"M10 2a6 6 0 0 0-6 6c0 1.887-.454 3.665-1.257 5.234a.75.75 0 0 0 .515 1.076 32.91 32.91 0 0 0 3.256.508 3.5 3.5 0 0 0 6.972 0 32.903 32.903 0 0 0 3.256-.508.75.75 0 0 0 .515-1.076A11.448 11.448 0 0 1 16 8a6 6 0 0 0-6-6Zm0 14.5a2 2 0 0 1-1.95-1.557 33.54 33.54 0 0 0 3.9 0A2 2 0 0 1 10 16.5Z",clipRule:"evenodd"}))}const q=r.forwardRef(W);function X({title:a,titleId:s,...t},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),a?r.createElement("title",{id:s},a):null,r.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm3.857-9.809a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z",clipRule:"evenodd"}))}const M=r.forwardRef(X);function J({title:a,titleId:s,...t},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),a?r.createElement("title",{id:s},a):null,r.createElement("path",{fillRule:"evenodd",d:"M3 3.5A1.5 1.5 0 0 1 4.5 2h6.879a1.5 1.5 0 0 1 1.06.44l4.122 4.12A1.5 1.5 0 0 1 17 7.622V16.5a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 3 16.5v-13Zm10.857 5.691a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 0 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z",clipRule:"evenodd"}))}const Q=r.forwardRef(J);function Y({title:a,titleId:s,...t},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),a?r.createElement("title",{id:s},a):null,r.createElement("path",{fillRule:"evenodd",d:"M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495ZM10 5a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 10 5Zm0 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z",clipRule:"evenodd"}))}const D=r.forwardRef(Y);function ee({title:a,titleId:s,...t},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),a?r.createElement("title",{id:s},a):null,r.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-7-4a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM9 9a.75.75 0 0 0 0 1.5h.253a.25.25 0 0 1 .244.304l-.459 2.066A1.75 1.75 0 0 0 10.747 15H11a.75.75 0 0 0 0-1.5h-.253a.25.25 0 0 1-.244-.304l.459-2.066A1.75 1.75 0 0 0 9.253 9H9Z",clipRule:"evenodd"}))}const _=r.forwardRef(ee);function ae({title:a,titleId:s,...t},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),a?r.createElement("title",{id:s},a):null,r.createElement("path",{d:"m5.433 13.917 1.262-3.155A4 4 0 0 1 7.58 9.42l6.92-6.918a2.121 2.121 0 0 1 3 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 0 1-.65-.65Z"}),r.createElement("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0 0 10 3H4.75A2.75 2.75 0 0 0 2 5.75v9.5A2.75 2.75 0 0 0 4.75 18h9.5A2.75 2.75 0 0 0 17 15.25V10a.75.75 0 0 0-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5Z"}))}const V=r.forwardRef(ae);function se({title:a,titleId:s,...t},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},t),a?r.createElement("title",{id:s},a):null,r.createElement("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"}))}const Z=r.forwardRef(se),te={success:{bg:"bg-success/50",border:"border-green-200",text:"text-primary",buttonBg:"border-success hover:border-success/90 text-primary"},warning:{bg:"bg-warning/50",border:"border-orange-200",text:"text-warning",buttonBg:"border-warning hover:border-warning/90 text-primary"},danger:{bg:"bg-danger/50",border:"border-red-200",text:"text-danger",buttonBg:"border-danger hover:border-danger/90 text-primary"},info:{bg:"bg-info/50",border:"border-sky-200",text:"text-primary",buttonBg:"border-primary hover:border-primary/90 text-primary"},neutral:{bg:"bg-dark/50",border:"border-gray-200",text:"text-dark",buttonBg:"border-dark hover:border-dark/90 text-primary"}},re={info:e.jsx(_,{className:"h-10 w-10"}),question:e.jsx(U,{className:"h-10 w-10"}),success:e.jsx(M,{className:"h-10 w-10"}),warning:e.jsx(D,{className:"h-10 w-10"}),danger:e.jsx(D,{className:"h-10 w-10"}),neutral:e.jsx(_,{className:"h-10 w-10"})};function le({title:a,icon:s,children:t,variant:l="info",actionText:m,onAction:c,className:x=""}){const o=te[l];return e.jsx("div",{className:`${o.bg} border ${o.border} rounded-lg p-2 ${x}`,role:"status","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:`${o.text}`,children:re[s??l]}),e.jsxs("div",{className:"flex-1 gap-0",children:[a&&e.jsx("h5",{className:`${o.text}`,children:a}),e.jsx("p",{className:`${o.text}`,children:t})]}),m&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx(E,{variant:"link",onClick:c,className:`${o.buttonBg}`,text:m,defaultArrow:!0})})]})})}function Ce({id:a,title:s,description:t,completed:l,inProgress:m,locked:c,cta:x,href:o,onAction:u,className:i}){const n=()=>{c||(o&&(window.location.href=o),u?.(a))};return e.jsxs("div",{className:`flex flex-col gap-4 rounded-lg border p-4 lg:p-6 relative transition-all duration-200 ${l?" border-success cursor-pointer":c?"bg-light/30 border-dark cursor-not-allowed":"border-warning cursor-pointer"} ${i}`,onClick:n,children:[e.jsx("h4",{className:"text-primary",children:s}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:t.replace(/\\/g,`
`)}),e.jsx(E,{href:o,variant:c?"link":l?"secondary":"primary",text:x,disabled:c,onClick:()=>!c&&u?.(a)}),l&&e.jsx("span",{className:"absolute top-1 lg:top-4 right-1 lg:right-4 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-success/30 text-success",children:"âœ… Completed"}),m&&e.jsx("span",{className:"absolute  top-1 lg:top-4 right-1 lg:right-4 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-warning/30 text-warning",children:"â³ In Progress"})]})}function k(...a){return a.filter(Boolean).join(" ")}const O={left:"justify-start",center:"justify-center",right:"justify-end"};function ne({tabs:a=[],defaultTabId:s,onChange:t,align:l="left"}){const m=s?Math.max(0,a.findIndex(i=>i.id===s)):0,[c,x]=r.useState(Math.min(Math.max(m,0),Math.max(0,a.length-1))),o=a[c]||a[0];function u(i){i<0||i>=a.length||(x(i),t?.(a[i].id))}return e.jsxs("div",{children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{"aria-label":"Tabs",className:k("-mb-px flex space-x-2",O[l]||O.left),children:a.map((i,n)=>e.jsx("button",{onClick:()=>u(n),"aria-current":n===c?"page":void 0,className:k(n===c?"border-secondary text-secondary":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700","group inline-flex items-center border-b-2 px-1 py-4 text-sm font-medium bg-transparent"),type:"button",children:e.jsx("span",{className:"truncate",children:i.label})},i.id))})}),e.jsx("div",{className:"mt-4",children:o?o.content:e.jsx("div",{})})]})}function ie({title:a,subtitle:s,icon:t,info1:l,info2:m,onClick:c,className:x="border-gray-200 bg-white"}){return e.jsxs("div",{role:c?"button":void 0,onClick:c,className:`flex items-center justify-between gap-4 rounded-lg border p-3 hover:shadow-sm ${x}`,children:[t&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-green-50",children:t})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("p",{className:"font-bold",children:a})}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("small",{className:"font-bold",children:s})})]}),e.jsxs("div",{className:"ml-4 flex-shrink-0 text-right",children:[l?e.jsx("div",{children:e.jsx("small",{children:l})}):null,m?e.jsx("div",{children:e.jsx("small",{children:m})}):null]})]})}function Ie({progress:a=[],alerts:s=[]}){return e.jsx(ne,{align:"right",tabs:[{id:"progress",label:e.jsx(N,{icon:e.jsx(Q,{}),size:"md",color:"transparent",className:"text-info","aria-label":"progress",children:"Progress"}),content:e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:a.map(t=>e.jsx(ie,{...t},t.title))})},{id:"alerts",label:e.jsx(N,{icon:e.jsx(q,{}),size:"md",color:"transparent",className:"text-warning","aria-label":"alerts",children:"Alerts"}),content:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:s.map(t=>e.jsx(le,{title:t.title,variant:t.variant,actionText:t.actionText,children:t.children},t.id))})}]})}function oe({value:a,transportModeId:s,livingLabId:t,onChange:l,onCancel:m}){const[c,x]=r.useState(!1),[o,u]=r.useState(a?.status??p.NOT_AVAILABLE),[i,n]=r.useState(a?.id),f={[p.NOT_AVAILABLE]:{color:"light",shortLabel:"Not Available"},[p.IN_SERVICE]:{color:"info",shortLabel:"In Service"},[p.NEW]:{color:"success",shortLabel:"New"},[p.OPTIMIZATION_SCHEDULED]:{color:"warning",shortLabel:"To optimize"}},b=h=>{u(h)},d=()=>{if(!i){const h=Math.floor(Math.random()*1e6);n(h)}i&&o&&(l?.({id:i,status:o,transport_mode_id:s,living_lab_id:t}),x(!1))},g=()=>{u(a?.status??p.NOT_AVAILABLE),m?.(),x(!1)};return c?e.jsxs("form",{onSubmit:d,className:"flex flex-col items-start space-x-3 gap-2 w-40",children:[e.jsx(y,{className:"w-36",children:e.jsx(H,{name:"status",value:o,onChange:h=>b(h.target.value),children:Object.values(p).map(h=>e.jsx("option",{value:h,children:h},h))})}),e.jsxs("div",{className:"flex flex-row justify-end items-end w-full space-x-2",children:[e.jsx("button",{type:"submit","aria-label":"Save",onClick:d,className:"inline-flex items-center",children:e.jsx(M,{className:"h-5 w-5 text-success"})}),e.jsx("button",{type:"button","aria-label":"Cancel",onClick:g,className:"inline-flex items-center",children:e.jsx(Z,{className:"h-5 w-5 text-dark"})})]})]}):e.jsxs("div",{className:"flex justify-end items-end gap-1 w-40",children:[e.jsx(N,{size:"sm",color:f[o]?.color,className:"","aria-label":`${o} status in living lab`,children:f[o]?.shortLabel}),e.jsx("button",{type:"button","aria-label":"Edit",onClick:()=>x(!0),className:"inline-flex items-center",children:e.jsx(V,{className:"h-5 w-5 text-[--color-primary]"})})]})}function S({kpiId:a,initial:s,livingLabId:t,transportModeId:l,defaultDate:m,onChange:c}){const x=h=>s?.value!==void 0&&s?.value!==null?Math.round(Number(s.value)*100)/100:void 0,[o,u]=r.useState(!1),[i,n]=r.useState(x(s?.value)),[f,b]=r.useState(T(s?.date??m));r.useEffect(()=>{n(x(s?.value)),b(T(s?.date??m))},[s,m]);const d=h=>{h?.preventDefault();let w=s?.id;w||(w=Date.now()),c?.({id:w,value:Number(i),date:f,transport_mode_id:l}),u(!1)},g=()=>{n(x(s?.value)),s?.date?b(s?.date):b(""),u(!1)};return o?e.jsxs("form",{onSubmit:d,className:"flex flex-col items-start space-x-3 gap-2 w-34",children:[e.jsxs(y,{className:"w-32",children:[e.jsx(L,{children:"Value"}),e.jsx(I,{type:"number",name:"value",value:i,onChange:h=>n(Number(h.target.value)),className:"mt-0 m-O"})]}),e.jsxs(y,{className:"w-32",children:[e.jsx(L,{children:"Date"}),e.jsx(I,{type:"date",name:"date",value:f,onChange:h=>b(h.target.value)})]}),e.jsxs("div",{className:"flex flex-row justify-end items-end w-full space-x-2",children:[e.jsx("button",{type:"submit","aria-label":"Save",onClick:d,className:"inline-flex items-center",children:e.jsx(M,{className:"h-5 w-5 text-success"})}),e.jsx("button",{type:"button","aria-label":"Cancel",onClick:g,className:"inline-flex items-center",children:e.jsx(Z,{className:"h-5 w-5 text-dark"})})]})]}):e.jsxs("div",{className:"flex items-start gap-1  w-34",children:[e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("p",{children:i??"-"}),i&&f&&e.jsx("span",{className:"text-[12px]",children:f})]}),e.jsx("button",{type:"button","aria-label":"Edit",onClick:()=>u(!0),className:"inline-flex items-center",children:e.jsx(V,{className:"h-5 w-5 text-[--color-primary]"})})]})}function F({onChangeBeforeDate:a,onChangeAfterDate:s}){const t=new Date().toISOString().slice(0,10),[l,m]=r.useState(t),[c,x]=r.useState(t),o=i=>{const n=i.target.value;m(n),a(n)},u=i=>{const n=i.target.value;x(n),s(n)};return e.jsxs("div",{className:"mb-4 flex flex-col lg:flex-row items-center gap-8",children:[e.jsxs(y,{children:[e.jsx(L,{children:"Collection date BEFORE Implementation"}),e.jsx("small",{children:"This date will be set by default for all new KPIs."}),e.jsx(I,{type:"date",name:"data-collection-date",value:l,onChange:o,className:"mt-0 m-O"})]}),e.jsxs(y,{children:[e.jsx(L,{children:"Collection date AFTER Implementation"}),e.jsx("small",{children:"This date will be set by default for all new KPIs."}),e.jsx(I,{type:"date",name:"data-collection-date",value:c,onChange:u,className:"mt-0 m-O"})]})]})}function ce({type:a="PUBLIC_TRANSPORT",size:s="sm"}){const t={[C.NSM]:{color:"success",shortLabel:"NSM",description:"New Mobility Service"},[C.PUBLIC_TRANSPORT]:{color:"primary-light",shortLabel:"PT",description:"Public Transport"},[C.PRIVATE]:{color:"warning",shortLabel:"Private",description:"Private Transport (eg. car, bike)"}};return e.jsx(N,{size:s,color:t[a].color,className:"","aria-label":`${a} KPI badge`,tooltip:t[a].description,children:t[a].shortLabel})}function Ae({modes:a=[],kpis:s=[],livingLabId:t,livingLabTransportModes:l=[],kpiResults:m=[]}){const c=new Date().toISOString().slice(0,10),[x,o]=r.useState(c),[u,i]=r.useState(c),n=new Map(l.map(d=>[d.transport_mode_id,d])),[f,b]=r.useState(new Map(m.map(d=>[d.id,d])));return e.jsxs("div",{className:"bg-white shadow rounded-md",children:[e.jsx(F,{onChangeBeforeDate:o,onChangeAfterDate:i}),e.jsx("div",{className:"p-4 overflow-x-auto",children:e.jsxs(P,{dense:!0,striped:!0,className:"[--gutter:--spacing(6)] sm:[--gutter:--spacing(8)]",children:[e.jsx($,{children:e.jsxs(A,{children:[e.jsx(j,{className:"whitespace-normal break-words",children:"Name"}),e.jsx(j,{className:"whitespace-normal break-words",children:"Status"}),s.map(d=>e.jsx(j,{className:"font-extrabold whitespace-normal break-words text-primary",children:d.name},d.id))]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:a.map(d=>e.jsxs(A,{children:[e.jsxs(v,{className:"max-w-52 flex flex-col break-words",children:[e.jsx(ce,{type:d.type}),e.jsx("label",{className:"whitespace-normal break-words",children:d.name}),d.description&&e.jsx("small",{className:"italic w-48 whitespace-normal break-words",children:d.description})]}),e.jsx(v,{children:e.jsx(oe,{value:n.get(d.id),transportModeId:d.id,livingLabId:t})}),s.map(g=>e.jsxs(v,{className:"",children:[f.get(g.id)?.result_before?.transport_mode_id===d.id&&e.jsx("small",{children:"Value before"}),e.jsx(S,{livingLabId:t,kpiId:g.id,initial:f.get(g.id)?.result_before,transportModeId:d.id,defaultDate:x,onChange:h=>{b(w=>{const R=new Map(w),B=w.get(g.id);return R.set(g.id,{...B,result_before:{...B?.result_before,...h}}),R})}}),f.get(g.id)?.result_before?.transport_mode_id===d.id&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{}),e.jsx("small",{children:"Value after"}),e.jsx(S,{transportModeId:d.id,livingLabId:t,kpiId:g.id,initial:f.get(g.id)?.result_after,defaultDate:u})]})]},g.id))]},d.id))})]})})]})}function de({type:a="GLOBAL",size:s="sm"}){return e.jsx(N,{size:s,color:a==="GLOBAL"?"primary-light":"secondary",className:"","aria-label":`${a} KPI badge`,children:a})}function Le({kpis:a=[],livingLabId:s,kpiResults:t=[]}){if(!a||a.length===0)return e.jsx("div",{children:"No KPIs available."});const l=new Map(t.map(i=>[i.id,i])),m=new Date().toISOString().slice(0,10),[c,x]=r.useState(m),[o,u]=r.useState(m);return e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsx(F,{onChangeBeforeDate:x,onChangeAfterDate:u}),e.jsxs(P,{dense:!0,striped:!0,className:"[--gutter:--spacing(6)] sm:[--gutter:--spacing(8)]",children:[e.jsx($,{children:e.jsxs(A,{children:[e.jsx(j,{children:"KPI Number"}),e.jsx(j,{children:"Name"}),e.jsx(j,{children:"Value Before"}),e.jsx(j,{children:"Value After"})]})}),e.jsx(K,{children:a.map((i,n)=>e.jsxs(A,{children:[e.jsxs(v,{className:"flex flex-col w-22",children:[i.kpi_number,e.jsx(de,{type:i.type})]}),e.jsx(v,{className:"max-w-48 whitespace-pre-line break-words",children:i.name}),e.jsx(v,{className:"",children:e.jsx(S,{livingLabId:s,kpiId:i.id,initial:l.get(i.id)?.result_before,defaultDate:c})}),e.jsx(v,{className:"w-34",children:e.jsx(S,{livingLabId:s,kpiId:i.id,initial:l.get(i.id)?.result_after,defaultDate:o})})]},i.kpi_number??n))})]})]})}function Se({labs:a}){const[s,t]=r.useState(null),[l,m]=r.useState([50,10]),[c,x]=r.useState(4),o=l?`${l[0]},${l[1]}`:"no-center";r.useEffect(()=>{s&&s.coordinates?.lat&&s.coordinates?.lng&&(m([s.coordinates.lat,s.coordinates.lng]),x(6))},[s]);const u=n=>{switch(n){case"complete":return"bg-success";case"incomplete":return"bg-danger";case"in-progress":return"bg-warning"}},i=a.map(n=>({id:n.id,name:n.name,coordinates:n.coordinates,radius:n.radius*1e3,meta:{lab:n}}));return e.jsx("section",{className:"py-12 px-4 sm:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-dark mb-2",children:"Living Labs Across Europe"}),e.jsx("p",{className:"text-dark text-lg",children:"Explore where shared mobility innovation is happening with the SUM project. Click on a city or map marker to view details."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 h-[600px] rounded shadow overflow-hidden",children:[e.jsx(G,{markers:i,center:l,zoom:c,className:"h-full w-full z-0",onMarkerClick:n=>{if(n.meta&&n.meta.lab)t(n.meta.lab);else{const f=a.find(b=>b.id===n.id);f&&t(f)}}},o),s&&e.jsxs("div",{className:" lg:mr-80 bg-white rounded-lg p-3 shadow border border-primary sticky bottom-0 left-0 z-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-primary",children:[s.name," â€“ Living Lab Overview"]}),e.jsx("button",{onClick:()=>t(null),className:"text-sm text-danger hover:underline",children:"Close"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-1 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-dark font-semibold",children:"Total Measures"}),e.jsx("div",{className:"text-gray-700",children:s.totalMeasures})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-dark font-semibold",children:"Transport Modes"}),e.jsx("div",{className:"text-gray-700",children:s.transportModes})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-dark font-semibold",children:"KPIs (Before)"}),e.jsx("div",{className:"text-gray-700",children:s.kpisBefore})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-dark font-semibold",children:"KPIs (After)"}),e.jsx("div",{className:"text-gray-700",children:s.kpisAfter})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-dark font-semibold",children:"Sustainable Modal Split"}),e.jsxs("div",{className:"text-success font-medium",children:[s.sustainablePercentage*100,"%"]})]})]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1 justify-center",children:e.jsxs(E,{variant:"primary",href:z(`/lab-dashboard/${s.id}`),children:["ðŸ” Explore ",s.name," Living Lab"]})})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:a.map(n=>e.jsxs("div",{onClick:()=>t(n),className:`cursor-pointer p-4 rounded shadow bg-white hover:bg-primary-light transition border-l-4 ${u(n.status)}`,children:[e.jsx("h5",{className:"font-semibold text-primary",children:n.name}),e.jsxs("p",{children:[n.totalMeasures," Measures ",e.jsx("br",{}),n.transportModes," Modes"]})]},n.id))})]})]})})}export{Ce as CTACard,Ie as LabDashboardTabs,Le as LivingLabKPIs,Se as LivingLabsMapSection,Ae as TransportModesList};
